[{"path":"http://gabrielhoffman.github.io/qtlPlots/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Gabriel Hoffman. Author, maintainer.","code":""},{"path":"http://gabrielhoffman.github.io/qtlPlots/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hoffman G (2023). qtlPlots: Create QTL plots. R package version 0.0.7, https://github.com/GabrielHoffman/qtlPlots.","code":"@Manual{,   title = {qtlPlots: Create QTL plots},   author = {Gabriel Hoffman},   year = {2023},   note = {R package version 0.0.7},   url = {https://github.com/GabrielHoffman/qtlPlots}, }"},{"path":[]},{"path":"http://gabrielhoffman.github.io/qtlPlots/index.html","id":"install","dir":"","previous_headings":"","what":"Install","title":"Create QTL plots","text":"","code":"devtools::install_github(\"GabrielHoffman/qtlPlots\")"},{"path":"http://gabrielhoffman.github.io/qtlPlots/index.html","id":"description","dir":"","previous_headings":"","what":"Description","title":"Create QTL plots","text":"Plotting functions take GRanges object scores defines value plotted y-axis: plotMht() Manhattan plot local region plotPosterior() Posterior probabilities local region addition, 2 functions: plotEnsGenes() Plot ENSEMBL genes plotBed() Plot genome intervals simple example simulated data:","code":"suppressPackageStartupMessages({ library(GenomicRanges) library(qtlPlots) })   # simple example of QTL results df = data.frame(Chr         = 1,                 Position    = 1:100,                  Variant     = paste0('SNP', 1:100),                 p.value     = runif(100))  # Convert to GRanges gr = with(df,   GRanges(Chr,                  IRanges(start   = Position,                          width   = 1,                          Variant = Variant,                          score   = -log10(p.value))))   # where: genome interval to show wh = GRanges(1, IRanges(1, 100))                                      # example plot plotMht(gr, wh, recombRate=FALSE)"},{"path":"http://gabrielhoffman.github.io/qtlPlots/index.html","id":"example-on-real-caqtl-data","dir":"","previous_headings":"","what":"Example on real caQTL data","title":"Create QTL plots","text":"can also add plots eQTL GWAS","code":"# test combined plotting suppressPackageStartupMessages({ library(qtlPlots) library(ggplot2) library(GenomicRanges)  })  ensdb = EnsDb.Hsapiens.v75::EnsDb.Hsapiens.v75 # genes on hg19 # ensdb = EnsDb.Hsapiens.v86::EnsDb.Hsapiens.v86 # genes on hg38  # read data dir <- system.file(\"data\", package=\"qtlPlots\")   gr_caQTL = readRDS(paste0(dir, '/', \"gr_caQTL.RDS\")) gr_peaks = readRDS(paste0(dir, '/', \"gr_peaks.RDS\")) gr_finemap = readRDS(paste0(dir, '/', \"gr_finemap.RDS\"))  # plot results for this peak targetPeak = 'Peak_82668'  # where: get interval to plot wh = range(gr_caQTL[gr_caQTL$Gene == targetPeak])  # only keep results for target peak gr_caQTL_sub = gr_caQTL[which(gr_caQTL$Gene == targetPeak)] gr_finemap = gr_finemap[gr_finemap$feature == targetPeak]  # Manhattan plot ################  # identify variants in the candidate set gr_caQTL_sub$inCandidateSet = FALSE idx = gr_caQTL_sub$Variant %in% gr_finemap$Variant gr_caQTL_sub$inCandidateSet[idx] = TRUE  # recomb rate is hg19 fig_mht = plotMht( gr_caQTL_sub, wh )  # Posteriors #############  fig_post = plotPosterior( gr_finemap, wh )  # Plot genes ############  fig_gene = plotEnsGenes( ensdb, wh)  # ATAC-seq peaks #################  # highlight the target peak gr_peaks$status = 0 gr_peaks$status[names(gr_peaks) == targetPeak] = 1  fig_bed = plotBed( gr_peaks, wh )  # Combine into multi-track plot ###############################  fig_track = ggbio::tracks(      \"caQTL\"        = fig_mht,      \"caQTL Fine map\"= fig_post,     'Gene'          = fig_gene,     'ATAC'          = fig_bed,     xlim = wh,     padding = unit(-.65, \"lines\"),      label.bg.fill=\"navy\",      label.text.color=\"white\",     heights=c(1, .6, .2, .1),     title = targetPeak)  fig_track@mutable['Genes'] = FALSE fig_track"},{"path":"http://gabrielhoffman.github.io/qtlPlots/reference/plotBed.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot BED intervals — plotBed","title":"Plot BED intervals — plotBed","text":"Plot BED intervals","code":""},{"path":"http://gabrielhoffman.github.io/qtlPlots/reference/plotBed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot BED intervals — plotBed","text":"","code":"plotBed(grObj, wh)"},{"path":"http://gabrielhoffman.github.io/qtlPlots/reference/plotBed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot BED intervals — plotBed","text":"grObj GRanges object scores posterior inclusion probability wh genome interval plot","code":""},{"path":"http://gabrielhoffman.github.io/qtlPlots/reference/plotEnsGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot ENSEMBL genes — plotEnsGenes","title":"Plot ENSEMBL genes — plotEnsGenes","text":"Plot ENSEMBL genes region","code":""},{"path":"http://gabrielhoffman.github.io/qtlPlots/reference/plotEnsGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot ENSEMBL genes — plotEnsGenes","text":"","code":"plotEnsGenes(   ensdb,   wh,   splice_variants = FALSE,   non_coding = FALSE,   arrow.size = 0.05,   ensGene = NULL,   size = 8 )"},{"path":"http://gabrielhoffman.github.io/qtlPlots/reference/plotEnsGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot ENSEMBL genes — plotEnsGenes","text":"ensdb ENSEMBL database object like EnsDb.Hsapiens.v86 wh genome interval plot splice_variants TRUE, show multiple transcripts gene non_coding TRUE, also show non-coding genes arrow.size arrow size genes ensGene show specific non-coding locus size font size","code":""},{"path":"http://gabrielhoffman.github.io/qtlPlots/reference/plotEnsGenes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot ENSEMBL genes — plotEnsGenes","text":"ggplot2 genome region","code":""},{"path":"http://gabrielhoffman.github.io/qtlPlots/reference/plotEnsGenes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot ENSEMBL genes — plotEnsGenes","text":"","code":"library(EnsDb.Hsapiens.v86) #> Loading required package: ensembldb #> Loading required package: BiocGenerics #>  #> Attaching package: 'BiocGenerics' #> The following objects are masked from 'package:stats': #>  #>     IQR, mad, sd, var, xtabs #> The following objects are masked from 'package:base': #>  #>     Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append, #>     as.data.frame, basename, cbind, colnames, dirname, do.call, #>     duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted, #>     lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin, #>     pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table, #>     tapply, union, unique, unsplit, which.max, which.min #> Loading required package: GenomicRanges #> Loading required package: stats4 #> Loading required package: S4Vectors #>  #> Attaching package: 'S4Vectors' #> The following objects are masked from 'package:base': #>  #>     I, expand.grid, unname #> Loading required package: IRanges #> Loading required package: GenomeInfoDb #> Loading required package: GenomicFeatures #> Loading required package: AnnotationDbi #> Loading required package: Biobase #> Welcome to Bioconductor #>  #>     Vignettes contain introductory material; view with #>     'browseVignettes()'. To cite Bioconductor, see #>     'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'. #> Loading required package: AnnotationFilter #>  #> Attaching package: 'ensembldb' #> The following object is masked from 'package:stats': #>  #>     filter library(GenomicRanges)   # gene database ensdb = EnsDb.Hsapiens.v86  # interval query = GRanges(\"20\", IRanges(62045027,62164563))  # plot genes plotEnsGenes( ensdb, query)"},{"path":"http://gabrielhoffman.github.io/qtlPlots/reference/plotMht.html","id":null,"dir":"Reference","previous_headings":"","what":"Zoom in manhattan plot — plotMht","title":"Zoom in manhattan plot — plotMht","text":"Zoom manhattan plot","code":""},{"path":"http://gabrielhoffman.github.io/qtlPlots/reference/plotMht.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Zoom in manhattan plot — plotMht","text":"","code":"plotMht(grObj, wh, size = 8, ptSize = 1, recombRate = TRUE)"},{"path":"http://gabrielhoffman.github.io/qtlPlots/reference/plotMht.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Zoom in manhattan plot — plotMht","text":"grObj GRanges object scores -log10 p-value wh genome interval plot size font size ptSize size points recombRate show recombination rate","code":""},{"path":"http://gabrielhoffman.github.io/qtlPlots/reference/plotPosterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Zoom in manhattan plot of posteriors — plotPosterior","title":"Zoom in manhattan plot of posteriors — plotPosterior","text":"Zoom manhattan plot posteriors","code":""},{"path":"http://gabrielhoffman.github.io/qtlPlots/reference/plotPosterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Zoom in manhattan plot of posteriors — plotPosterior","text":"","code":"plotPosterior(grObj, wh, size = 8, ymax = 1)"},{"path":"http://gabrielhoffman.github.io/qtlPlots/reference/plotPosterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Zoom in manhattan plot of posteriors — plotPosterior","text":"grObj GRanges object scores posterior inclusion probability wh genome interval plot size font size ymax max value y axis","code":""}]
